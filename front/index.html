<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiloAI</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <img id="logo" src="assets/logos/MILO-BLEU.png" alt="LogoMilo">
            <img id="logo-right" src="assets/logos/ECE_LOGO_bleu.png" alt="LogoECE">
        </header>

        <main>
            <canvas id="particle-sphere"></canvas>
            <div id="vision-preview" style="position:absolute; right:10px; top:80px; background:#000; padding:6px; border-radius:8px; display:none;">
              <img id="vision-img" src="" alt="vision" style="max-width:280px; max-height:180px; display:block;">
              <div id="vision-caption" style="color:#fff; font-size:12px; margin-top:4px; max-width:280px;"></div>
            </div>
        </main>
        <div id="text-zone">
            <p id="milo_text">Bonjour !</p>
        </div>
        <button id="play-audio-btn" type="button" style="display:none;">
                <img id="btn-play" src="assets/icons/VOCAL-fond-noir.png" alt="ButtonPlay">
        </button>
        <footer>
            <button id="button1" type="button">
                <img src="assets/icons/CROIX-fond-noir.png" alt="Button1">
            </button>
            <button id="button2" type="button">
                <img id="btn2_img" src="assets/icons/REC_launch_BLEU.png" alt="Button2">
            </button>
            <button id="button3" type="button">
                <img src="assets/icons/MICRO-fond-noir.png" alt="Button3">
            </button>
            <button id="button4" type="button">
                <img src="assets/icons/EYE-fond-noir.png" alt="Button4">
            </button>
        </footer>
    </div>
</body>

<script src="scripts/particleSphere.js"></script>
<script src="scripts/textZone.js"></script>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="scripts/buttons.js"></script>
<script src="scripts/audioPlay.js"></script>
<script>
    (function(){
      const isFile = window.location.protocol === 'file:';
      const baseURL = isFile ? 'http://localhost:5000' : window.location.origin;
      window.__MILO_BASE_URL__ = baseURL;
      const socket = io(baseURL);
      socket.on("vision_detection", (data) => {
        console.log("vision_detection:", data);
        if (data && data.image_url) {
          const imgEl = document.getElementById('vision-img');
          const box = document.getElementById('vision-preview');
          imgEl.src = baseURL + data.image_url + `?t=${Date.now()}`;
          box.style.display = 'block';
          const cap = document.getElementById('vision-caption');
          cap.textContent = data.caption || '';
        }
      });
    })();
  </script>


